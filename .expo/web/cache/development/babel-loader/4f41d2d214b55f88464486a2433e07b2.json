{"ast":null,"code":"\"use strict\";\n\nvar _extends = require(\"@babel/runtime/helpers/extends\");\n\nvar _slicedToArray = require(\"@babel/runtime/helpers/slicedToArray\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.usePopover = void 0;\n\nvar react_1 = require(\"react\");\n\nvar react_native_1 = require(\"react-native-web/dist/index\");\n\nfunction usePopover() {\n  var calculateStatusBar = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n  var touchableRef = react_1.useRef(null);\n\n  var _react_1$useState = react_1.useState({\n    showPopover: false,\n    popoverAnchor: {\n      x: 0,\n      y: 0,\n      width: 0,\n      height: 0\n    }\n  }),\n      _react_1$useState2 = _slicedToArray(_react_1$useState, 2),\n      _react_1$useState2$ = _react_1$useState2[0],\n      showPopover = _react_1$useState2$.showPopover,\n      popoverAnchor = _react_1$useState2$.popoverAnchor,\n      setState = _react_1$useState2[1];\n\n  var result = react_1.useMemo(function () {\n    var openPopover = function openPopover() {\n      var handle = react_native_1.findNodeHandle(touchableRef.current);\n\n      if (handle) {\n        react_native_1.NativeModules.UIManager.measure(handle, onTouchableMeasured);\n      }\n    };\n\n    var onTouchableMeasured = function onTouchableMeasured(_x0, _y0, width, height, x, y) {\n      var _a;\n\n      var dimensions = react_native_1.Dimensions.get('window');\n      setState({\n        showPopover: true,\n        popoverAnchor: {\n          x: react_native_1.I18nManager.isRTL ? dimensions.width - x : x,\n          y: y - (calculateStatusBar ? (_a = react_native_1.StatusBar.currentHeight) !== null && _a !== void 0 ? _a : 0 : 0),\n          width: width,\n          height: height\n        }\n      });\n    };\n\n    var closePopover = function closePopover() {\n      return setState(function (s) {\n        return _extends(_extends({}, s), {\n          showPopover: false\n        });\n      });\n    };\n\n    return {\n      openPopover: openPopover,\n      closePopover: closePopover,\n      touchableRef: touchableRef,\n      popoverVisible: showPopover,\n      popoverAnchorRect: popoverAnchor\n    };\n  }, [calculateStatusBar, touchableRef, showPopover, popoverAnchor, setState]);\n  var openPopover = result.openPopover;\n  react_1.useEffect(function () {\n    var onOrientationChange = function onOrientationChange() {\n      if (showPopover) {\n        requestAnimationFrame(openPopover);\n      }\n    };\n\n    react_native_1.Dimensions.addEventListener('change', onOrientationChange);\n    return function () {\n      react_native_1.Dimensions.removeEventListener('change', onOrientationChange);\n    };\n  }, [showPopover, openPopover]);\n  return result;\n}\n\nexports.usePopover = usePopover;","map":{"version":3,"sources":["../src/usePopover.ts"],"names":[],"mappings":";;;;;;;;;;;AAAA,IAAA,OAAA,GAAA,OAAA,CAAA,OAAA,CAAA;;;;AAwBA,SAAgB,UAAhB,GAAqD;EAAA,IAA1B,kBAA0B,uEAAL,KAAK;EACnD,IAAM,YAAY,GAAG,OAAA,CAAA,MAAA,CAAY,IAAZ,CAArB;;EAEA,wBAAmD,OAAA,CAAA,QAAA,CAAgB;IACjE,WAAW,EAAE,KADoD;IAEjE,aAAa,EAAE;MAAE,CAAC,EAAE,CAAL;MAAQ,CAAC,EAAE,CAAX;MAAc,KAAK,EAAE,CAArB;MAAwB,MAAM,EAAE;IAAhC;EAFkD,CAAhB,CAAnD;EAAA;EAAA;EAAA,IAAS,WAAT,uBAAS,WAAT;EAAA,IAAsB,aAAtB,uBAAsB,aAAtB;EAAA,IAAuC,QAAvC;;EAKA,IAAM,MAAM,GAAG,OAAA,CAAA,OAAA,CAAQ,YAAK;IAC1B,IAAM,WAAW,GAAG,SAAd,WAAc,GAAK;MACvB,IAAM,MAAM,GAAG,cAAA,CAAA,cAAA,CAAe,YAAY,CAAC,OAA5B,CAAf;;MACA,IAAI,MAAJ,EAAY;QACV,cAAA,CAAA,aAAA,CAAc,SAAd,CAAwB,OAAxB,CAAgC,MAAhC,EAAwC,mBAAxC;MACD;IACF,CALD;;IAOA,IAAM,mBAAmB,GAA6B,SAAhD,mBAAgD,CACpD,GADoD,EAEpD,GAFoD,EAGpD,KAHoD,EAIpD,MAJoD,EAKpD,CALoD,EAMpD,CANoD,EAOlD;;;MACF,IAAM,UAAU,GAAG,cAAA,CAAA,UAAA,CAAW,GAAX,CAAe,QAAf,CAAnB;MACA,QAAQ,CAAC;QACP,WAAW,EAAE,IADN;QAEP,aAAa,EAAE;UACb,CAAC,EAAE,cAAA,CAAA,WAAA,CAAY,KAAZ,GAAoB,UAAU,CAAC,KAAX,GAAmB,CAAvC,GAA2C,CADjC;UAEb,CAAC,EAAE,CAAC,IAAI,kBAAkB,GAAG,CAAA,EAAA,GAAA,cAAA,CAAA,SAAA,CAAU,aAAV,MAAuB,IAAvB,IAAuB,EAAA,KAAA,KAAA,CAAvB,GAAuB,EAAvB,GAA2B,CAA9B,GAAkC,CAAxD,CAFS;UAGb,KAAK,EAAL,KAHa;UAIb,MAAM,EAAN;QAJa;MAFR,CAAD,CAAR;IASD,CAlBD;;IAoBA,IAAM,YAAY,GAAG,SAAf,YAAe;MAAA,OAAM,QAAQ,CAAC,UAAC,CAAD;QAAA,OAAO,SAAA,SAAA,EAAA,EAAM,CAAN,CAAA,EAAO;UAAE,WAAW,EAAE;QAAf,CAAP,CAAP;MAAA,CAAD,CAAd;IAAA,CAArB;;IAEA,OAAO;MACL,WAAW,EAAX,WADK;MAEL,YAAY,EAAZ,YAFK;MAGL,YAAY,EAAZ,YAHK;MAIL,cAAc,EAAE,WAJX;MAKL,iBAAiB,EAAE;IALd,CAAP;EAOD,CArCc,EAqCZ,CAAC,kBAAD,EAAqB,YAArB,EAAmC,WAAnC,EAAgD,aAAhD,EAA+D,QAA/D,CArCY,CAAf;EAuCA,IAAQ,WAAR,GAAwB,MAAxB,CAAQ,WAAR;EAEA,OAAA,CAAA,SAAA,CAAU,YAAK;IACb,IAAM,mBAAmB,GAAG,SAAtB,mBAAsB,GAAK;MAC/B,IAAI,WAAJ,EAAiB;QAEf,qBAAqB,CAAC,WAAD,CAArB;MACD;IACF,CALD;;IAMA,cAAA,CAAA,UAAA,CAAW,gBAAX,CAA4B,QAA5B,EAAsC,mBAAtC;IACA,OAAO,YAAK;MACV,cAAA,CAAA,UAAA,CAAW,mBAAX,CAA+B,QAA/B,EAAyC,mBAAzC;IACD,CAFD;EAGD,CAXD,EAWG,CAAC,WAAD,EAAc,WAAd,CAXH;EAaA,OAAO,MAAP;AACD;;AA/DD,OAAA,CAAA,UAAA,GAAA,UAAA","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.usePopover = void 0;\nconst react_1 = require(\"react\");\nconst react_native_1 = require(\"react-native\");\nfunction usePopover(calculateStatusBar = false) {\n    const touchableRef = react_1.useRef(null);\n    const [{ showPopover, popoverAnchor }, setState] = react_1.useState({\n        showPopover: false,\n        popoverAnchor: { x: 0, y: 0, width: 0, height: 0 },\n    });\n    const result = react_1.useMemo(() => {\n        const openPopover = () => {\n            const handle = react_native_1.findNodeHandle(touchableRef.current);\n            if (handle) {\n                react_native_1.NativeModules.UIManager.measure(handle, onTouchableMeasured);\n            }\n        };\n        const onTouchableMeasured = (_x0, _y0, width, height, x, y) => {\n            var _a;\n            const dimensions = react_native_1.Dimensions.get('window');\n            setState({\n                showPopover: true,\n                popoverAnchor: {\n                    x: react_native_1.I18nManager.isRTL ? dimensions.width - x : x,\n                    y: y - (calculateStatusBar ? (_a = react_native_1.StatusBar.currentHeight) !== null && _a !== void 0 ? _a : 0 : 0),\n                    width,\n                    height,\n                },\n            });\n        };\n        const closePopover = () => setState((s) => (Object.assign(Object.assign({}, s), { showPopover: false })));\n        return {\n            openPopover,\n            closePopover,\n            touchableRef,\n            popoverVisible: showPopover,\n            popoverAnchorRect: popoverAnchor,\n        };\n    }, [calculateStatusBar, touchableRef, showPopover, popoverAnchor, setState]);\n    const { openPopover } = result;\n    react_1.useEffect(() => {\n        const onOrientationChange = () => {\n            if (showPopover) {\n                requestAnimationFrame(openPopover);\n            }\n        };\n        react_native_1.Dimensions.addEventListener('change', onOrientationChange);\n        return () => {\n            react_native_1.Dimensions.removeEventListener('change', onOrientationChange);\n        };\n    }, [showPopover, openPopover]);\n    return result;\n}\nexports.usePopover = usePopover;\n//# sourceMappingURL=usePopover.js.map"]},"metadata":{},"sourceType":"script"}